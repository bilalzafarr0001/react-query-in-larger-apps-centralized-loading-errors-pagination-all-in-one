{"ast":null,"code":"var _s = $RefreshSig$();\nimport jsonpatch from 'fast-json-patch';\nimport { useMutation } from 'react-query';\nimport { axiosInstance, getJWTHeader } from '../../../axiosInstance';\nimport { useUser } from './useUser';\n\n// for when we need a server function\nasync function patchUserOnServer(newData, originalData) {\n  if (!newData || !originalData) return null;\n\n  // create a patch for the difference between newData and originalData\n  const patch = jsonpatch.compare(originalData, newData);\n  console.log('patch :::::', patch);\n\n  // send patched data to the server\n  const {\n    data\n  } = await axiosInstance.patch(`/user/${originalData.id}`, {\n    patch\n  }, {\n    headers: getJWTHeader(originalData)\n  });\n  return data.user;\n}\n\n// TODO: update type to UseMutateFunction type\nexport function usePatchUser() {\n  _s();\n  const {\n    user,\n    updateUser\n  } = useUser();\n  const {\n    mutate: patchUser\n  } = useMutation(newUserData => patchUserOnServer(newUserData, user));\n  return patchUser;\n}\n_s(usePatchUser, \"x+pp1+VMbMwfmHTR2c1THoHvucg=\", false, function () {\n  return [useUser, useMutation];\n});","map":{"version":3,"names":["jsonpatch","useMutation","axiosInstance","getJWTHeader","useUser","patchUserOnServer","newData","originalData","patch","compare","console","log","data","id","headers","user","usePatchUser","updateUser","mutate","patchUser","newUserData"],"sources":["/home/muhammadbilal/Desktop/react-query-in-larger-apps-centralized-loading-errors-pagination-all-in-one/client/src/components/user/hooks/usePatchUser.ts"],"sourcesContent":["import jsonpatch from 'fast-json-patch';\nimport { useMutation, UseMutateFunction } from 'react-query';\nimport type { User } from '../../../../../shared/types';\nimport { axiosInstance, getJWTHeader } from '../../../axiosInstance';\nimport { useUser } from './useUser';\n\n// for when we need a server function\nasync function patchUserOnServer(\n  newData: User | null,\n  originalData: User | null,\n): Promise<User | null> {\n  if (!newData || !originalData) return null;\n\n  // create a patch for the difference between newData and originalData\n  const patch = jsonpatch.compare(originalData, newData);\n  console.log('patch :::::', patch);\n\n  // send patched data to the server\n  const { data } = await axiosInstance.patch(\n    `/user/${originalData.id}`,\n    { patch },\n    {\n      headers: getJWTHeader(originalData),\n    },\n  );\n  return data.user;\n}\n\n// TODO: update type to UseMutateFunction type\nexport function usePatchUser(): (newData: User | null) => void {\n  const { user, updateUser } = useUser();\n\n  const { mutate: patchUser } = useMutation((newUserData: User) =>\n    patchUserOnServer(newUserData, user),\n  );\n\n  return patchUser;\n}\n"],"mappings":";AAAA,OAAOA,SAAS,MAAM,iBAAiB;AACvC,SAASC,WAAW,QAA2B,aAAa;AAE5D,SAASC,aAAa,EAAEC,YAAY,QAAQ,wBAAwB;AACpE,SAASC,OAAO,QAAQ,WAAW;;AAEnC;AACA,eAAeC,iBAAiB,CAC9BC,OAAoB,EACpBC,YAAyB,EACH;EACtB,IAAI,CAACD,OAAO,IAAI,CAACC,YAAY,EAAE,OAAO,IAAI;;EAE1C;EACA,MAAMC,KAAK,GAAGR,SAAS,CAACS,OAAO,CAACF,YAAY,EAAED,OAAO,CAAC;EACtDI,OAAO,CAACC,GAAG,CAAC,aAAa,EAAEH,KAAK,CAAC;;EAEjC;EACA,MAAM;IAAEI;EAAK,CAAC,GAAG,MAAMV,aAAa,CAACM,KAAK,CACvC,SAAQD,YAAY,CAACM,EAAG,EAAC,EAC1B;IAAEL;EAAM,CAAC,EACT;IACEM,OAAO,EAAEX,YAAY,CAACI,YAAY;EACpC,CAAC,CACF;EACD,OAAOK,IAAI,CAACG,IAAI;AAClB;;AAEA;AACA,OAAO,SAASC,YAAY,GAAmC;EAAA;EAC7D,MAAM;IAAED,IAAI;IAAEE;EAAW,CAAC,GAAGb,OAAO,EAAE;EAEtC,MAAM;IAAEc,MAAM,EAAEC;EAAU,CAAC,GAAGlB,WAAW,CAAEmB,WAAiB,IAC1Df,iBAAiB,CAACe,WAAW,EAAEL,IAAI,CAAC,CACrC;EAED,OAAOI,SAAS;AAClB;AAAC,GAReH,YAAY;EAAA,QACGZ,OAAO,EAENH,WAAW;AAAA"},"metadata":{},"sourceType":"module"}